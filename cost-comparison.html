<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>10å¹´æˆæœ¬æ¯”è¼ƒè¨ˆç®—æ©Ÿ (TCO Comparison)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* é€™æ¬¡æˆ‘å€‘æ›å€‹æ¸…çˆ½çš„è—è‰²é¢¨æ ¼ */
        body { font-family: 'Segoe UI', sans-serif; display: flex; height: 100vh; margin: 0; background-color: #f0f2f5; }
        
        .sidebar {
            width: 320px;
            background: white;
            padding: 25px;
            border-right: 1px solid #ddd;
            overflow-y: auto;
        }

        h2 { color: #0073e6; border-bottom: 2px solid #0073e6; padding-bottom: 10px; }
        
        .control-section { margin-bottom: 30px; border: 1px solid #eee; padding: 15px; border-radius: 8px; }
        .control-section h3 { margin-top: 0; font-size: 16px; color: #555; }
        
        label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 14px; }
        input[type="range"] { width: 100%; margin-bottom: 5px; cursor: pointer; }
        .val-display { float: right; color: #0073e6; }

        .main-content { flex: 1; padding: 40px; display: flex; flex-direction: column; align-items: center; }
        .chart-box { width: 90%; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        
        /* çµæœæ‘˜è¦å€ */
        .result-cards { display: flex; gap: 20px; margin-bottom: 20px; width: 90%; }
        .card { flex: 1; background: white; padding: 15px; border-radius: 8px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border-top: 4px solid #ccc; }
        .card.winner { border-top-color: #28a745; background-color: #f0fff4; } /* è´å®¶è®Šç¶ è‰² */
    </style>
</head>
<body>

    <div class="sidebar">
        <h2>åƒæ•¸è¨­å®š (Inputs)</h2>

        <div class="control-section">
            <h3>ğŸ”´ æ–¹æ¡ˆ A (èˆŠè¨­å‚™/å‚³çµ±)</h3>
            
            <label>åˆå§‹è³¼è²·æˆæœ¬ ($) <span id="valA_init" class="val-display">0</span></label>
            <input type="range" id="inputA_init" min="0" max="50000" step="1000" value="0">
            
            <label>æ¯å¹´ç¶­è­·/é›»è²» ($) <span id="valA_ops" class="val-display">8000</span></label>
            <input type="range" id="inputA_ops" min="1000" max="20000" step="500" value="8000">
        </div>

        <div class="control-section">
            <h3>ğŸ”µ æ–¹æ¡ˆ B (æ–°è¨­å‚™/ç¯€èƒ½)</h3>
            
            <label>åˆå§‹è³¼è²·æˆæœ¬ ($) <span id="valB_init" class="val-display">20000</span></label>
            <input type="range" id="inputB_init" min="0" max="100000" step="1000" value="20000">
            
            <label>æ¯å¹´ç¶­è­·/é›»è²» ($) <span id="valB_ops" class="val-display">3000</span></label>
            <input type="range" id="inputB_ops" min="1000" max="20000" step="500" value="3000">
        </div>
    </div>

    <div class="main-content">
        <div class="result-cards">
            <div class="card" id="cardA">
                <h4>æ–¹æ¡ˆ A ç¸½èŠ±è²» (10å¹´)</h4>
                <h2 id="totalA">$0</h2>
            </div>
            <div class="card" id="cardB">
                <h4>æ–¹æ¡ˆ B ç¸½èŠ±è²» (10å¹´)</h4>
                <h2 id="totalB">$0</h2>
            </div>
            <div class="card">
                <h4>å›æœ¬æ™‚é–“ (Break-even)</h4>
                <h2 id="breakeven" style="color: #e67e22;">è¨ˆç®—ä¸­...</h2>
            </div>
        </div>

        <div class="chart-box">
            <canvas id="costChart"></canvas>
        </div>
    </div>

    <script>
        // 1. æŠ“å–å…ƒç´ 
        const inputs = {
            a_init: document.getElementById('inputA_init'),
            a_ops:  document.getElementById('inputA_ops'),
            b_init: document.getElementById('inputB_init'),
            b_ops:  document.getElementById('inputB_ops')
        };

        // 2. åˆå§‹åŒ–åœ–è¡¨ (é€™æ¬¡æ˜¯ Line Chart æŠ˜ç·šåœ–)
        const ctx = document.getElementById('costChart').getContext('2d');
        const costChart = new Chart(ctx, {
            type: 'line', // è¨­å®šç‚ºæŠ˜ç·šåœ–
            data: {
                labels: ['Y0', 'Y1', 'Y2', 'Y3', 'Y4', 'Y5', 'Y6', 'Y7', 'Y8', 'Y9', 'Y10'], // Xè»¸ï¼šå¹´ä»½
                datasets: [
                    {
                        label: 'æ–¹æ¡ˆ A (ç´¯ç©æˆæœ¬)',
                        data: [],
                        borderColor: '#ff6384', // ç´…è‰²ç·š
                        backgroundColor: 'rgba(255, 99, 132, 0.1)',
                        fill: false,
                        tension: 0.3 // è®“ç·šæ¢ç¨å¾®åœ“æ»‘ä¸€é»
                    },
                    {
                        label: 'æ–¹æ¡ˆ B (ç´¯ç©æˆæœ¬)',
                        data: [],
                        borderColor: '#36a2eb', // è—è‰²ç·š
                        backgroundColor: 'rgba(54, 162, 235, 0.1)',
                        fill: false,
                        tension: 0.3
                    }
                ]
            },
            options: {
                responsive: true,
                interaction: { mode: 'index', intersect: false }, // æ»‘é¼ ç§»ä¸Šå»åŒæ™‚é¡¯ç¤ºå…©æ¢ç·šçš„æ•¸å€¼
                scales: {
                    y: { title: { display: true, text: 'ç´¯ç©èŠ±è²» ($)' } }
                }
            }
        });

        // 3. è¨ˆç®—é‚è¼¯ (æ ¸å¿ƒå¤§è…¦)
        function calculate() {
            // è®€å–æ•¸å€¼
            let a_init = parseInt(inputs.a_init.value);
            let a_ops  = parseInt(inputs.a_ops.value);
            let b_init = parseInt(inputs.b_init.value);
            let b_ops  = parseInt(inputs.b_ops.value);

            // æ›´æ–°å·¦å´æ–‡å­—é¡¯ç¤º
            document.getElementById('valA_init').innerText = a_init;
            document.getElementById('valA_ops').innerText  = a_ops;
            document.getElementById('valB_init').innerText = b_init;
            document.getElementById('valB_ops').innerText  = b_ops;

            // ç”¢ç”Ÿ 10 å¹´çš„æ•¸æ“šé™£åˆ—
            let dataA = [];
            let dataB = [];
            let years = 10;
            let breakEvenYear = "ç„¡äº¤å‰";

            for(let i = 0; i <= years; i++) {
                // å…¬å¼ï¼šç´¯ç©æˆæœ¬ = åˆå§‹æˆæœ¬ + (å¹´ä»½ * æ¯å¹´ç‡Ÿé‹è²»)
                let costA = a_init + (i * a_ops);
                let costB = b_init + (i * b_ops);
                
                dataA.push(costA);
                dataB.push(costB);

                // åˆ¤æ–·å›æœ¬é»ï¼šå¦‚æœé€™ä¸€å¹´ B çš„ç¸½èŠ±è²»é–‹å§‹å°æ–¼ Aï¼Œä¸”å‰ä¸€å¹´é‚„æ˜¯ B å¤§æ–¼ A
                if (i > 0 && costB < costA && dataB[i-1] >= dataA[i-1]) {
                    breakEvenYear = "ç¬¬ " + i + " å¹´";
                }
            }

            // æ›´æ–°åœ–è¡¨
            costChart.data.datasets[0].data = dataA;
            costChart.data.datasets[1].data = dataB;
            costChart.update();

            // æ›´æ–°ä¸Šæ–¹æ‘˜è¦å¡ç‰‡
            let finalA = dataA[10];
            let finalB = dataB[10];
            document.getElementById('totalA').innerText = "$" + finalA.toLocaleString();
            document.getElementById('totalB').innerText = "$" + finalB.toLocaleString();
            document.getElementById('breakeven').innerText = breakEvenYear;

            // èª°è´å°±æŠŠèª°çš„å¡ç‰‡è®Šç¶ è‰²
            document.getElementById('cardA').classList.toggle('winner', finalA < finalB);
            document.getElementById('cardB').classList.toggle('winner', finalB < finalA);
        }

        // 4. ç¶å®šäº‹ä»¶ (è®“æ»‘æ¡¿å‹•èµ·ä¾†)
        Object.values(inputs).forEach(input => {
            input.addEventListener('input', calculate);
        });

        // ä¸€é–‹å§‹å…ˆç®—ä¸€æ¬¡
        calculate();
    </script>
</body>
</html>